<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenBinder: Environment Variables</title>
<link href="doxygenPSI.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<h1><a class="anchor" name="EnvironmentVars">Environment Variables</a></h1><div class="header"> <center>&lt; <a class="el" href="BinderThreading.html">Threading Conventions</a> | <a class="el" href="main.html#OpenBinder">OpenBinder</a> | <a class="el" href="SupportKit.html">Support Kit</a> &gt;</center> <hr>
 </div><p>
The following are environment variables supported by the main Binder system  that is, libbinder, and thus everything that links against it.<p>
<ol type=1>
<li><a class="el" href="EnvironmentVars.html#EnvVarPaths">Paths</a><ol type=a>
<li><a class="el" href="EnvironmentVars.html#BINDER_PACKAGE_PATH">BINDER_PACKAGE_PATH</a></li></ol>
</li><li><a class="el" href="EnvironmentVars.html#EnvVarBehavior">Behavior</a><ol type=a>
<li><a class="el" href="EnvironmentVars.html#TEXT_OUTPUT_FORMAT">TEXT_OUTPUT_FORMAT</a></li><li><a class="el" href="EnvironmentVars.html#BINDER_NO_CONTEXT_SECURITY">BINDER_NO_CONTEXT_SECURITY</a></li><li><a class="el" href="EnvironmentVars.html#BINDER_SHOW_LOAD_UNLOAD">BINDER_SHOW_LOAD_UNLOAD</a></li><li><a class="el" href="EnvironmentVars.html#BINDER_SINGLE_PROCESS">BINDER_SINGLE_PROCESS</a></li></ol>
</li><li><a class="el" href="EnvironmentVars.html#EnvVarDebugging">Debugging</a><ol type=a>
<li><a class="el" href="EnvironmentVars.html#ATOM_DEBUG">ATOM_DEBUG</a></li><li><a class="el" href="EnvironmentVars.html#BINDER_IPC_PROFILE">BINDER_IPC_PROFILE</a></li><li><a class="el" href="EnvironmentVars.html#BINDER_PROCESS_WRAPPER">BINDER_PROCESS_WRAPPER</a></li><li><a class="el" href="EnvironmentVars.html#LOCK_DEBUG">LOCK_DEBUG</a></li><li><a class="el" href="EnvironmentVars.html#VECTOR_PROFILE">VECTOR_PROFILE</a></li></ol>
</li></ol>
<h2><a class="anchor" name="EnvVarPaths">
Paths</a></h2>
These variables allow you to control where the Binder finds various parts of itself.<p>
<a class="anchor" name="BINDER_PACKAGE_PATH"></a> <h3><a class="anchor" name="BINDER_PACKAGE_PATH">
BINDER_PACKAGE_PATH</a></h3>
This is a ":"separated list of directories where the <a class="el" href="BinderTerminology.html#PackageManagerDefn">Package Manager</a> should find packages. This variable <em>must</em> be set when running <a class="el" href="Contents.html#smooved">smooved</a>, so that when it starts the package manager it will be able to find the Binder Shell component and other services it needs.<p>
For example:<p>
<div class="fragment"><pre class="fragment">export BINDER_PACKAGE_PATH=~/openbinder/build/packages
</pre></div><h2><a class="anchor" name="EnvVarBehavior">
Behavior</a></h2>
These variables control how the Binder system behaves and displays messages.<p>
<a class="anchor" name="TEXT_OUTPUT_FORMAT"></a> <h3><a class="anchor" name="TEXT_OUTPUT_FORMAT">
TEXT_OUTPUT_FORMAT</a></h3>
This variable allows you to control formatting of text sent to the standard output streams (bout, berr, etc). It contains a series of characters describing which formatting options to enable. Each character can be prefixed with a '!', indicating that option should be disbled. The available options are:<p>
<ul>
<li><b>m:</b> Multi-threaded output. The text stream will perform buffering of each thread writing into it, so that threads only write complete lines. This avoids the mixing together of partial lines when two threads are writing at the same time.</li><li><b>c:</b> Colored output. Each line of output is colored by the thread that produced it. The color is selected based on the thread ID.</li><li><b>p:</b> Add a prefix to the front of each line with the id of the process it came from.</li><li><b>t:</b> Add a prefix to the front of each line with the id of the thread it came from.</li><li><b>w:</b> Add a prefix to the front of each line with the timestamp when it was written.</li></ul>
<p>
For example, to enable multi-threaded colored output with a prefix showing the process but not the thread, you can do this:<p>
<div class="fragment"><pre class="fragment">export TEXT_OUTPUT_FORMAT='mcp!t'
</pre></div><p>
<a class="anchor" name="BINDER_NO_CONTEXT_SECURITY"></a> <h3><a class="anchor" name="BINDER_NO_CONTEXT_SECURITY">
BINDER_NO_CONTEXT_SECURITY</a></h3>
Setting this variable to a non-zero value disables the simple context permissions in <a class="el" href="Contents.html#smooved">smooved</a>, so that any process can get access to any context. By default, processes only get access to the user context.<p>
<a class="anchor" name="BINDER_SHOW_LOAD_UNLOAD"></a> <h3><a class="anchor" name="BINDER_SHOW_LOAD_UNLOAD">
BINDER_SHOW_LOAD_UNLOAD</a></h3>
When set to a non-zero integer, the Binder will print out informative messages as it loads and unloads package code.<p>
<a class="anchor" name="BINDER_SINGLE_PROCESS"></a> <h3><a class="anchor" name="BINDER_SINGLE_PROCESS">
BINDER_SINGLE_PROCESS</a></h3>
When set to a non-zero integer, the Binder will attempt to keep code running in th same process, as much as possible. Currently this means that calling <a class="el" href="classSContext.html#a8">SContext::NewProcess()</a> will return the local <a class="el" href="classIProcess.html">IProcess</a>, unless the flag <a class="el" href="classSContext.html#w0w5">SContext::REQUIRE_REMOTE</a> is used.<p>
See <a class="el" href="BinderProcessModel.html">Binder Process Model</a> for more information on how the Binder manages processes.<p>
It is important to understand the distinction between using <code>BINDER_SINGLE_PROCESS=1</code> with the Binder kernel module available, and not having the kernel module at all:<h4><a class="anchor" name="WithKernelModule">
With Kernel Module</a></h4>
When the kernel module is available, even if you set <code>BINDER_SINGLE_PROCESS=1</code>, the Binder runtime will still open the module and use it for various things. For example, it will still be used to manage the thread pool and schedule message delivery to <a class="el" href="classSHandler.html">SHandler</a> objects.<p>
In addition, <a class="el" href="Contents.html#smooved">smooved</a> will still set itself as the <a class="el" href="classSContext.html">SContext</a> host. This means that you can still create other processes (such as with the bsh command), which can connect back to the root context and do IPC with other objects.<h4><a class="anchor" name="WithoutKernelModule">
Without Kernel Module</a></h4>
When the kernel module is not available, there is no IPC available at all. For example, trying to run the bsh command will result in an error saying it could not find the root context, just as if smooved hadn't been running at all.<p>
A more subtle distinction is that in this case the thread pool can't use the kernel module to schedule <a class="el" href="classSHandler.html">SHandler</a> objects. Instead, it uses a different purely user-space implementation. This can lead to subtle differences in behavior between the two environments. (Assuming there aren't outright bugs in one implementation or the other.)<h2><a class="anchor" name="EnvVarDebugging">
Debugging</a></h2>
These variables allow you to enable and control various debugging facilities provided by the Binder.<p>
<a class="anchor" name="ATOM_DEBUG"></a> <h3><a class="anchor" name="ATOM_DEBUG">
ATOM_DEBUG</a></h3>
Atom debugging is a tool for tracking <a class="el" href="classSAtom.html">SAtom</a> reference count leaks. See <a class="el" href="SAtomDebugging.html">SAtom Debugging</a> for more information.<p>
<a class="anchor" name="BINDER_IPC_PROFILE"></a> <h3><a class="anchor" name="BINDER_IPC_PROFILE">
BINDER_IPC_PROFILE</a></h3>
Setting this variable to 1 will enable a profiler of the Binder's IPC mechanism, designed to help client programs discover "hot spots" where they are doing too much IPC.<p>
In each process, the profiler makes a note of each outgoing IPC operation from that process and the stack crawl associated with it. After every X number of IPCs have happened, it prints a report of the total number of IPCs and the top N instigators of IPCs organized by stack crawl.<p>
When the IPC profiler is enabled, you can use these additional environment variables to customize its behavior:<p>
<ul>
<li><b>BINDER_IPC_PROFILE_DUMP_PERIOD</b> is the number of IPC operations between each time the profiler statistics are displayed. The default value is 500.</li><li><b>BINDER_IPC_PROFILE_MAX_ITEMS</b> is the maximum number of unique stack crawls display  i.e., the top N callers to display. The default value is 10.</li><li><b>BINDER_IPC_PROFILE_STACK_DEPTH</b> is the maximum depth that stack crawls can be. This is useful to tune what statistics are being displayed. For example, a smaller number will result in fewer bins because there are fewer possible paths into the IPC mechanism.</li><li><b>BINDER_IPC_PROFILE_SYMBOLS</b> if non-zero, the default, will display symbol information in the stack crawl, making it much more verbose but easier to understand.</li></ul>
<p>
<a class="anchor" name="BINDER_PROCESS_WRAPPER"></a> <h3><a class="anchor" name="BINDER_PROCESS_WRAPPER">
BINDER_PROCESS_WRAPPER</a></h3>
The variable supplies a "wrapper" command to run between caller of <a class="el" href="classSContext.html#a8">SContext::NewProcess()</a> and the actual process it returns. This can be useful to insert xterm and/or gdb sessions into the process, for separating the output of multiple processes and easily catching crashes.<p>
Using this variable usually requires creating a set of scripts and files to accomplish what you want in the wrapper process. The OpenBinder build system generates some scripts under build/scripts that create an xterm with gdb running inside of it. You can set <code>BINDER_PROCESS_WRAPPER</code> as follows to use these scripts:<p>
<div class="fragment"><pre class="fragment">export BINDER_PROCESS_WRAPPER=~/openbinder/build/scripts/process_wrapper.sh
</pre></div><p>
<a class="anchor" name="LOCK_DEBUG"></a> <h3><a class="anchor" name="LOCK_DEBUG">
LOCK_DEBUG</a></h3>
These variables control SLocker's debugging / deadlock detection code. This is enabled by default in debug builds. You can explicitly turn it off by setting <code>LOCK_DEBUG=0</code>. The <code>LOCK_DEBUG_STACK_CRAWLS</code> can likewise be set to 0 to not collect stack information as the deadlock detection runs  this can allow you to run deadlock detection with less performance impact.<p>
<a class="anchor" name="VECTOR_PROFILE"></a> <h3><a class="anchor" name="VECTOR_PROFILE">
VECTOR_PROFILE</a></h3>
The <code>VECTOR_PROFILE</code> tools collects usage statistics on the <a class="el" href="classSVector.html">SVector</a> class. When enabled, it will print regular reports of the kinds of <a class="el" href="classSVector.html">SVector</a> operations that are being performed. The variable <code>VECTOR_PROFILE_DUMP_PERIOD</code> controls how often reports are printed; its default value is 1000. <div class="footer">
<hr>
<!--address style="align: right;"-->
<I>
<small>
<a href="http://www.palmsource.com/"><img name="ps_logo" src="../ps_logo.gif" width="96" height="54" align="left" border="0" alt=""></a>  Generated on Wed Dec 28 22:33:33 2005 by Doxygen 1.4.4 for OpenBinder Documentation Version 1.0
<P>
<a href="http://www.palmsource.com/">PalmSource, Inc.</A> &copy; 2005 &nbsp;
</small>
<!--/address-->
</I>
</div>
</body>
</html>
